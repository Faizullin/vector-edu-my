import{N as m,j as e,z as p,s as d,r as y}from"./index-DQh6-uld.js";import{c as g,L as x,u as f,D as h}from"./use-resource-D_Sf-gj9.js";import{H as b,T as j,P as T,M as S}from"./theme-switch-CZRbTvJb.js";import{S as _}from"./search-Cxg_x99o.js";import{B as w}from"./badge-CaQ6wKJ8.js";import{c as N}from"./index-DxnMLqFP.js";import{u as v,C as F}from"./component-base-BGAKgd9u.js";import{S as C}from"./select-dropdown-zAryhJnq.js";import{F as k,a as M,b as P,c as D,d as H,e as L}from"./zod-DllzZRz3.js";import{u as R}from"./use-custom-toast-M785XCYm.js";import{c as U}from"./dropdown-menu-DzwRwAUd.js";import"./search-context-BRsiDa6R.js";import"./scroll-area-Dbi-VXH4.js";import"./IconSun-DUeqE8X5.js";import"./createReactComponent-CHdwuXdO.js";import"./separator-B8KvN21v.js";import"./use-auth-D3uw0lD2.js";import"./useMutation-DppR1fuU.js";import"./handle-server-error-BxJ_sWNo.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]],E=U("toggle-left",B),c=[{label:"Бесплатный",value:"free"},{label:"Оплаченный",value:"paid"},{label:"Премиум оплаченный",value:"premium_paid"}],V=p.object({user_type:p.enum(c.map(a=>a.value),{required_error:"User type is required."})}),q=m.create(({userIds:a})=>{const l=m.useModal(),{showSuccessToast:n,showErrorToast:r}=R(),o=v({schema:V,defaultValues:{user_type:null},notifications:{onSuccess:s=>n({title:s}),onError:(s,t)=>r({title:s,description:t})},transformToApi(s){return{user_ids:a,user_type:s.user_type}},fetchFn:s=>d({url:"/accounts/users/toggle-user-type/",method:"POST",formData:{user_ids:a,user_type:o.form.getValues("user_type")}})});return e.jsx(F,{formHook:o,modal:l,displayType:"dialog",getTitle:s=>"Toggle users",formName:"user-form",getSubmitButtonText:s=>"Save",children:({control:s})=>e.jsx(k,{...o.form,children:e.jsx("div",{className:"space-y-4 p-0.5 mb-6",children:e.jsx(M,{control:s,name:"user_type",render:({field:t})=>e.jsxs(P,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(D,{className:"col-span-2 text-right",children:"User Type"}),e.jsx(H,{children:e.jsx(C,{items:c,defaultValue:t.value,onValueChange:t.onChange,placeholder:"Select user type",className:"col-span-4",isControlled:!0})}),e.jsx(L,{className:"col-span-4 col-start-3"})]})})})})})}),i=g(),I=new Map([["premium_paid","bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],["free","bg-neutral-300/40 border-neutral-300"],["paid","bg-sky-200/40 text-sky-900 dark:text-sky-100 border-sky-300"]]);function z(){const a=y.useMemo(()=>[i.accessor("id",{header:"ID",meta:{filter:{type:"text",displayType:"toolbar"}},enableHiding:!1}),i.accessor("username",{header:"Username",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},cell:({row:r})=>e.jsx(x,{className:"max-w-36",children:r.getValue("username")}),enableHiding:!1}),i.accessor("email",{header:"Email",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"}}}),i.accessor("user_type",{header:"Payment",enableSorting:!1,cell:({row:r})=>{var t;const{user_type:o}=r.original,s=I.get(o);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(w,{variant:"outline",className:N("capitalize",s),children:(t=c.find(u=>u.value===o))==null?void 0:t.label})})},meta:{filter:{type:"select",options:c,displayType:"toolbar"}}})],[]),l=f({name:"users",url:"/accounts/users",columns:a,useRowSelection:!0}),n=l.datatable.table.getSelectedRowModel();return e.jsxs(e.Fragment,{children:[e.jsxs(b,{fixed:!0,children:[e.jsx(_,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(j,{}),e.jsx(T,{})]})]}),e.jsx(S,{children:e.jsx(h,{resource:l,topbar:{title:"User List",subtitle:"Manage your users and their roles here."},actions:[{id:"toggle-payment",label:"Toggle Payment",renderType:"actions-menu",callback:()=>{m.show(q,{userIds:n.rows.map(r=>r.original.id)}).then(()=>{l.query.refetch()})},disabled:n.rows.length===0,shortcutIcon:e.jsx(E,{})}]})})]})}const ie=z;export{ie as component};
