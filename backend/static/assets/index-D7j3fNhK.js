import{N as r,r as m,j as e}from"./index-BmiyAELg.js";import{a as S,s as N}from"./use-auth-js2yB0WI.js";import{a as P,C,S as M,c as w,L as D,D as F}from"./select-dropdown-BLzGuQJg.js";import{D as v,a as I}from"./delete-confirm-nice-dialog-BuUCB31W.js";import{H as E,T as _,P as k,M as H}from"./theme-switch-_yrpSE89.js";import{S as q}from"./search-BqZfjb3Q.js";import{B as A}from"./badge-BDni1Y-G.js";import{u as y,c as B,a as L}from"./use-custom-toast-CvPjYmcL.js";import{c as R}from"./createReactComponent-DAnOonP9.js";import{F as V,a as f,b as h,c as b,d as z,I as O,e as g,z as d}from"./index-vTqYkbZ5.js";import{P as $}from"./plus-D9oxXjnl.js";import"./search-context-emn1PgDM.js";import"./IconSun-CD0sLG3_.js";import"./handle-server-error-D0TgnIKM.js";const p=[{label:"Published",value:"1"},{label:"Draft",value:"0"}],K=d.object({title:d.string().min(1,{message:"Title is required."}),publication_status:d.string().min(1,{message:"Publication status is required."})}),j=r.create(o=>{const c=r.useModal(),n=m.useMemo(()=>o.recordId?"edit":"create",[o.recordId]),{showSuccessToast:l,showErrorToast:u}=y(),t=P({schema:K,apiService:w({url:"/resources/posts"}),queryKey:"posts",invalidateQueriesOnMutate:!0,initialMode:n,recordId:o.recordId,defaultValues:{title:"",publication_status:"0"},transformToForm(s){return{title:s.title,publication_status:s.publication_status.toString()}},notifications:{onSuccess:s=>{l({title:s,duration:2e3})},onError:s=>{u({title:s,duration:2e3})}}});return e.jsx(C,{formHook:t,modal:c,displayType:"dialog",getTitle:s=>s.formMode==="edit"?"Edit Post":"Create Post",formName:"posts-form",children:({control:s})=>e.jsx(V,{...t.form,children:e.jsxs("div",{className:"space-y-4 p-0.5 mb-6",children:[e.jsx(f,{control:s,name:"title",render:({field:a})=>e.jsxs(h,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(b,{className:"col-span-2 text-right",children:"Title"}),e.jsx(z,{children:e.jsx(O,{placeholder:"Title",className:"col-span-4",autoComplete:"off",...a})}),e.jsx(g,{className:"col-span-4 col-start-3"})]})}),e.jsx(f,{control:s,name:"publication_status",render:({field:a})=>e.jsxs(h,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(b,{className:"col-span-2 text-right",children:"Publication Status"}),e.jsx(M,{defaultValue:a.value,onValueChange:a.onChange,placeholder:"Select",className:"col-span-4",items:p,isControlled:!0}),e.jsx(g,{className:"col-span-4 col-start-3"})]})})]})})})}),i=B(),Q=new Map([[1,"bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],[0,"bg-neutral-300/40 border-neutral-300"]]);function G(){const{showSuccessToast:o}=y(),c=S({mutationFn:t=>N({url:`/resources/posts/${t}/`,method:"DELETE"})}),n=m.useMemo(()=>[i.accessor("id",{header:"ID",meta:{filter:{type:"text",displayType:"toolbar"}},enableHiding:!1}),i.accessor("title",{header:"Title",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},cell:({row:t})=>e.jsx(D,{className:"max-w-36",children:t.getValue("title")}),enableHiding:!1}),i.accessor("publication_status",{header:"Publication",enableSorting:!1,cell:({row:t})=>{var x;const{publication_status:s}=t.original,a=Q.get(s);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(A,{variant:"outline",className:R("capitalize",a),children:(x=p.find(T=>T.value===`${s}`))==null?void 0:x.label})})},meta:{filter:{type:"select",options:p,displayType:"toolbar"}}}),i.display({id:"actions",cell:({row:t})=>e.jsx(v,{row:t,defaultActions:{edit:{callback:({row:s})=>{r.show(j,{recordId:s.original.id,record:s.original})}},delete:{callback:({row:s})=>{r.show(I,{}).then(({result:a})=>{a&&(o({title:"Post deleted successfully",duration:2e3}),c.mutateAsync(s.original.id).then(()=>{l.query.refetch()}))})}}}})})],[]),l=L({name:"posts",url:"/resources/posts",columns:n}),u=m.useCallback(()=>{r.show(j,{})},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(E,{fixed:!0,children:[e.jsx(q,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(_,{}),e.jsx(k,{})]})]}),e.jsx(H,{children:e.jsx(F,{resource:l,topbar:{title:"Post List",subtitle:"Manage your posts."},actions:[{id:"add",label:"Add",renderType:"panel",callback:u,shortcutIcon:e.jsx($,{})}]})})]})}const ce=G;export{ce as component};
