import{N as m,j as e,r as d}from"./index-BmiyAELg.js";import{u as y,C as g,S as x,L as f,D as h}from"./select-dropdown-BLzGuQJg.js";import{H as b,T as j,P as T,M as S}from"./theme-switch-_yrpSE89.js";import{S as _}from"./search-BqZfjb3Q.js";import{B as w}from"./badge-BDni1Y-G.js";import{u as N,c as v,a as F}from"./use-custom-toast-CvPjYmcL.js";import{c as C}from"./createReactComponent-DAnOonP9.js";import{s as k}from"./use-auth-js2yB0WI.js";import{F as M,a as P,b as D,c as H,d as L,e as R,z as u}from"./index-vTqYkbZ5.js";import{c as U}from"./IconSun-CD0sLG3_.js";import"./search-context-emn1PgDM.js";import"./handle-server-error-D0TgnIKM.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]],E=U("toggle-left",B),i=[{label:"Бесплатный",value:"free"},{label:"Оплаченный",value:"paid"},{label:"Премиум оплаченный",value:"premium_paid"}],V=u.object({user_type:u.enum(i.map(t=>t.value),{required_error:"User type is required."})}),q=m.create(({userIds:t})=>{const l=m.useModal(),{showSuccessToast:n,showErrorToast:r}=N(),o=y({schema:V,defaultValues:{user_type:null},notifications:{onSuccess:s=>n({title:s}),onError:(s,a)=>r({title:s,description:a})},transformToApi(s){return{user_ids:t,user_type:s.user_type}},fetchFn:s=>k({url:"/accounts/users/toggle-user-type/",method:"POST",formData:{user_ids:t,user_type:o.form.getValues("user_type")}})});return e.jsx(g,{formHook:o,modal:l,displayType:"dialog",getTitle:s=>"Toggle users",formName:"user-form",getSubmitButtonText:s=>"Save",children:({control:s})=>e.jsx(M,{...o.form,children:e.jsx("div",{className:"space-y-4 p-0.5 mb-6",children:e.jsx(P,{control:s,name:"user_type",render:({field:a})=>e.jsxs(D,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(H,{className:"col-span-2 text-right",children:"User Type"}),e.jsx(L,{children:e.jsx(x,{items:i,defaultValue:a.value,onValueChange:a.onChange,placeholder:"Select user type",className:"col-span-4",isControlled:!0})}),e.jsx(R,{className:"col-span-4 col-start-3"})]})})})})})}),c=v(),I=new Map([["premium_paid","bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],["free","bg-neutral-300/40 border-neutral-300"],["paid","bg-sky-200/40 text-sky-900 dark:text-sky-100 border-sky-300"]]);function z(){const t=d.useMemo(()=>[c.accessor("id",{header:"ID",meta:{filter:{type:"text",displayType:"toolbar"}},enableHiding:!1}),c.accessor("username",{header:"Username",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},cell:({row:r})=>e.jsx(f,{className:"max-w-36",children:r.getValue("username")}),enableHiding:!1}),c.accessor("email",{header:"Email",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"}}}),c.accessor("user_type",{header:"Payment",enableSorting:!1,cell:({row:r})=>{var a;const{user_type:o}=r.original,s=I.get(o);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(w,{variant:"outline",className:C("capitalize",s),children:(a=i.find(p=>p.value===o))==null?void 0:a.label})})},meta:{filter:{type:"select",options:i,displayType:"toolbar"}}})],[]),l=F({name:"users",url:"/accounts/users",columns:t,useRowSelection:!0}),n=l.datatable.table.getSelectedRowModel();return e.jsxs(e.Fragment,{children:[e.jsxs(b,{fixed:!0,children:[e.jsx(_,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(j,{}),e.jsx(T,{})]})]}),e.jsx(S,{children:e.jsx(h,{resource:l,topbar:{title:"User List",subtitle:"Manage your users and their roles here."},actions:[{id:"toggle-payment",label:"Toggle Payment",renderType:"actions-menu",callback:()=>{m.show(q,{userIds:n.rows.map(r=>r.original.id)}).then(()=>{l.query.refetch()})},disabled:n.rows.length===0,shortcutIcon:e.jsx(E,{})}]})})]})}const se=z;export{se as component};
