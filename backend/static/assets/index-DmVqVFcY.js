import{N as r,r as m,j as e}from"./index-BFkE31IL.js";import{a as S,s as N}from"./use-auth-DHccd34A.js";import{u as P,c as C,C as M,L as w,D}from"./component-base-rkrblrFW.js";import{D as F,a as v}from"./delete-confirm-nice-dialog-a-e420zC.js";import{H as I,T as E,P as _,M as k}from"./theme-switch-DqUBxbL4.js";import{S as H}from"./search-DUc9O2sE.js";import{B as q}from"./badge-DAHE-SyF.js";import{u as y,I as A}from"./use-custom-toast-CqH72_jF.js";import{c as B,u as L}from"./use-resource-DK3NFxGu.js";import{c as R}from"./createReactComponent-D3fbIqZl.js";import{S as V}from"./select-dropdown-DMRw24fp.js";import{z as d,F as z,a as f,b as h,c as b,d as O,e as g}from"./index-RzghFC-a.js";import{P as $}from"./plus-CBxvFzmc.js";import"./search-context-Cmagidv2.js";import"./IconSun-DCedqkE3.js";const p=[{label:"Published",value:"1"},{label:"Draft",value:"0"}],K=d.object({title:d.string().min(1,{message:"Title is required."}),publication_status:d.string().min(1,{message:"Publication status is required."})}),j=r.create(o=>{const c=r.useModal(),n=m.useMemo(()=>o.recordId?"edit":"create",[o.recordId]),{showSuccessToast:l,showErrorToast:u}=y(),t=P({schema:K,apiService:C({url:"/resources/posts"}),queryKey:"posts",invalidateQueriesOnMutate:!0,initialMode:n,recordId:o.recordId,defaultValues:{title:"",publication_status:"0"},transformToForm(s){return{title:s.title,publication_status:s.publication_status.toString()}},notifications:{onSuccess:s=>{l({title:s,duration:2e3})},onError:s=>{u({title:s,duration:2e3})}}});return e.jsx(M,{formHook:t,modal:c,displayType:"dialog",getTitle:s=>s==="edit"?"Edit Post":"Create Post",formName:"posts-form",children:({control:s})=>e.jsx(z,{...t.form,children:e.jsxs("div",{className:"space-y-4 p-0.5",children:[e.jsx(f,{control:s,name:"title",render:({field:a})=>e.jsxs(h,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(b,{className:"col-span-2 text-right",children:"Title"}),e.jsx(O,{children:e.jsx(A,{placeholder:"Title",className:"col-span-4",autoComplete:"off",...a})}),e.jsx(g,{className:"col-span-4 col-start-3"})]})}),e.jsx(f,{control:s,name:"publication_status",render:({field:a})=>e.jsxs(h,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(b,{className:"col-span-2 text-right",children:"Publication Status"}),e.jsx(V,{defaultValue:a.value,onValueChange:a.onChange,placeholder:"Select",className:"col-span-4",items:p,isControlled:!0}),e.jsx(g,{className:"col-span-4 col-start-3"})]})})]})})})}),i=B(),Q=new Map([[1,"bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],[0,"bg-neutral-300/40 border-neutral-300"]]);function G(){const{showSuccessToast:o}=y(),c=S({mutationFn:t=>N({url:`/resources/posts/${t}/`,method:"DELETE"})}),n=m.useMemo(()=>[i.accessor("id",{header:"ID",meta:{filter:{type:"text",displayType:"toolbar"}},enableHiding:!1}),i.accessor("title",{header:"Title",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},cell:({row:t})=>e.jsx(w,{className:"max-w-36",children:t.getValue("title")}),enableHiding:!1}),i.accessor("publication_status",{header:"Publication",enableSorting:!1,cell:({row:t})=>{var x;const{publication_status:s}=t.original,a=Q.get(s);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(q,{variant:"outline",className:R("capitalize",a),children:(x=p.find(T=>T.value===`${s}`))==null?void 0:x.label})})},meta:{filter:{type:"select",options:p,displayType:"toolbar"}}}),i.display({id:"actions",cell:({row:t})=>e.jsx(F,{row:t,defaultActions:{edit:{callback:({row:s})=>{r.show(j,{recordId:s.original.id,record:s.original})}},delete:{callback:({row:s})=>{r.show(v,{}).then(({result:a})=>{a&&(o({title:"Post deleted successfully",duration:2e3}),c.mutateAsync(s.original.id).then(()=>{l.query.refetch()}))})}}}})})],[]),l=L({name:"posts",url:"/resources/posts/",columns:n}),u=m.useCallback(()=>{r.show(j,{})},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(I,{fixed:!0,children:[e.jsx(H,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(E,{}),e.jsx(_,{})]})]}),e.jsx(k,{children:e.jsx(D,{resource:l,topbar:{title:"Post List",subtitle:"Manage your posts."},actions:[{id:"add",label:"Add",renderType:"panel",callback:u,shortcutIcon:e.jsx($,{})}]})})]})}const ne=G;export{ne as component};
