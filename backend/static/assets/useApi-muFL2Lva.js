import{a8 as w,a9 as g,r as l,K as P,D as c}from"./main-CUfsI3AY.js";const b=`${g.api.baseUrl}${g.api.v1Url}`,y=w.create({baseURL:b,withCredentials:!0});function I(e){let s=null;if(document.cookie&&document.cookie!==""){const t=document.cookie.split(";");for(let i=0;i<t.length;i++){const n=t[i].trim();if(n.substring(0,e.length+1)===e+"="){s=decodeURIComponent(n.substring(e.length+1));break}}}return s}function R(){return I("csrftoken")}y.interceptors.request.use(e=>{const s=R();return s&&(e.headers["X-CSRFToken"]=s),e},e=>Promise.reject(e));y.interceptors.response.use(e=>e,e=>{if(e.response){const s=e.response.status;if([401,403].includes(s)){console.warn("Session expired or unauthorized! Redirecting to login...");const t=window.location.href;window.location.href=`/${g.routes.base_href}${g.routes.login}?next=${t}`}}return Promise.reject(e)});const x=async(e,s={})=>await y.get(e,{params:s});function $(e,s={}){const t={usePagination:!0,useInitial:!1,useDisplayError:!0,...s},[i,n]=l.useState(null),[h,d]=l.useState(!1),[E,k]=l.useState(1),p=l.useCallback(async(D={},o={})=>{const f={url:o.url!==void 0?o.url:e,usePagination:o.usePagination!==void 0?o.usePagination:t.usePagination,useInitial:o.useInitial!==void 0?o.useInitial:t.useInitial,useDisplayError:o.useDisplayError!==void 0?o.useDisplayError:t.useDisplayError};d(!0);try{const r={...D};f.usePagination||(r.disablePagination=!0);const a=await x(f.url,r);return a.status===200&&(f.usePagination?(n(a.data.results),k(a.data.totalPages??1)):n(a.data)),d(!1),a.data}catch(r){if(d(!1),console.error(`Failed to fetch resources: ${r}`),f.useDisplayError&&r instanceof P)if(r.response.status===500)c.error("Unknown server error");else if(r.response.status===404)c.error("Resource not found");else{const a=r.response.data;a&&a.message?c.error(`${a.message}`):c.error("An unexpected request error occurred")}throw r}},[e]);return l.useEffect(()=>{t.useInitial&&p()},[p]),{data:i,loading:h,totalPages:E,fetchData:p}}function U(e={}){const[s,t]=l.useState(!1),[i,n]=l.useState(null),h={useDisplayError:!0,...e};return{mutate:async(E,k,p=null,D={},o={})=>{var r,a,m;const f={useDisplayError:o.useDisplayError!==void 0?o.useDisplayError:h.useDisplayError};t(!0),n(null);try{const u=await y({url:E,method:k,data:p,...D});return t(!1),u.data}catch(u){throw t(!1),n(u),f.useDisplayError&&u instanceof P&&((a=(r=u.response)==null?void 0:r.data)!=null&&a.message?c.error(u.response.data.message):((m=u.response)==null?void 0:m.status)===500?c.error("Unknown server error"):c.error("Request failed")),u}},loading:s,error:i}}export{b as A,$ as a,y as b,U as u};
