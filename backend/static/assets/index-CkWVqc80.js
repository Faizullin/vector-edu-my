import{N as r,r as d,j as e,z as m,s as S}from"./index-BNIGZ_sb.js";import{S as N,c as P,L as C,u as M,D as w}from"./select-dropdown-C0aPmqop.js";import{D,a as F}from"./delete-confirm-nice-dialog-COzuCIy0.js";import{H as v,T as I,P as E,M as _}from"./theme-switch-B3jb4bE2.js";import{S as k}from"./search-BmgROrh8.js";import{B as H}from"./badge-Pr4EMxX3.js";import{b as q,C as A,c as B,a as y}from"./use-custom-toast-DfXnhnWV.js";import{c as L}from"./index-CnYdjC-F.js";import{u as R}from"./useMutation-Bi3RyDN5.js";import{F as V,a as f,b,c as h,d as z,I as O,e as g}from"./zod-CBN5pmrC.js";import{P as $}from"./plus-BsEmJiJD.js";import"./dropdown-menu-CE0Hsqy3.js";import"./search-context-DMPW8H4z.js";import"./scroll-area-DaoqWUtW.js";import"./IconSun-CD4UHluS.js";import"./createReactComponent-Bxh2tW4K.js";import"./separator-Ca3_S96s.js";import"./use-auth-CDgyCKtq.js";const p=[{label:"Published",value:"1"},{label:"Draft",value:"0"}],K=m.object({title:m.string().min(1,{message:"Title is required."}),publication_status:m.string().min(1,{message:"Publication status is required."})}),j=r.create(o=>{const c=r.useModal(),n=d.useMemo(()=>o.recordId?"edit":"create",[o.recordId]),{showSuccessToast:l,showErrorToast:u}=y(),s=q({schema:K,apiService:B({url:"/resources/posts"}),queryKey:"posts",invalidateQueriesOnMutate:!0,initialMode:n,recordId:o.recordId,defaultValues:{title:"",publication_status:"0"},transformToForm(t){return{title:t.title,publication_status:t.publication_status.toString()}},notifications:{onSuccess:t=>{l({title:t,duration:2e3})},onError:t=>{u({title:t,duration:2e3})}}});return e.jsx(A,{formHook:s,modal:c,displayType:"dialog",getTitle:t=>t.formMode==="edit"?"Edit Post":"Create Post",formName:"posts-form",children:({control:t})=>e.jsx(V,{...s.form,children:e.jsxs("div",{className:"space-y-4 p-0.5 mb-6",children:[e.jsx(f,{control:t,name:"title",render:({field:a})=>e.jsxs(b,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(h,{className:"col-span-2 text-right",children:"Title"}),e.jsx(z,{children:e.jsx(O,{placeholder:"Title",className:"col-span-4",autoComplete:"off",...a})}),e.jsx(g,{className:"col-span-4 col-start-3"})]})}),e.jsx(f,{control:t,name:"publication_status",render:({field:a})=>e.jsxs(b,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(h,{className:"col-span-2 text-right",children:"Publication Status"}),e.jsx(N,{defaultValue:a.value,onValueChange:a.onChange,placeholder:"Select",className:"col-span-4",items:p,isControlled:!0}),e.jsx(g,{className:"col-span-4 col-start-3"})]})})]})})})}),i=P(),Q=new Map([[1,"bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],[0,"bg-neutral-300/40 border-neutral-300"]]);function G(){const{showSuccessToast:o}=y(),c=R({mutationFn:s=>S({url:`/resources/posts/${s}/`,method:"DELETE"})}),n=d.useMemo(()=>[i.accessor("id",{header:"ID",meta:{filter:{type:"text",displayType:"toolbar"}},enableHiding:!1}),i.accessor("title",{header:"Title",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},cell:({row:s})=>e.jsx(C,{className:"max-w-36",children:s.getValue("title")}),enableHiding:!1}),i.accessor("publication_status",{header:"Publication",enableSorting:!1,cell:({row:s})=>{var x;const{publication_status:t}=s.original,a=Q.get(t);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(H,{variant:"outline",className:L("capitalize",a),children:(x=p.find(T=>T.value===`${t}`))==null?void 0:x.label})})},meta:{filter:{type:"select",options:p,displayType:"toolbar"}}}),i.display({id:"actions",cell:({row:s})=>e.jsx(D,{row:s,defaultActions:{edit:{callback:({row:t})=>{r.show(j,{recordId:t.original.id,record:t.original})}},delete:{callback:({row:t})=>{r.show(F,{}).then(({result:a})=>{a&&(o({title:"Post deleted successfully",duration:2e3}),c.mutateAsync(t.original.id).then(()=>{l.query.refetch()}))})}}}})})],[]),l=M({name:"posts",url:"/resources/posts",columns:n}),u=d.useCallback(()=>{r.show(j,{})},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(v,{fixed:!0,children:[e.jsx(k,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(I,{}),e.jsx(E,{})]})]}),e.jsx(_,{children:e.jsx(w,{resource:l,topbar:{title:"Post List",subtitle:"Manage your posts."},actions:[{id:"add",label:"Add",renderType:"panel",callback:u,shortcutIcon:e.jsx($,{})}]})})]})}const de=G;export{de as component};
