import{N as u,j as e,r as p}from"./index-BFkE31IL.js";import{u as y,C as g,c as x,L as f,D as h}from"./component-base-rkrblrFW.js";import{H as b,T as j,P as T,M as S}from"./theme-switch-DqUBxbL4.js";import{S as v}from"./search-DUc9O2sE.js";import{B as w}from"./badge-DAHE-SyF.js";import{c as _,u as M}from"./use-resource-DK3NFxGu.js";import{c as N}from"./createReactComponent-D3fbIqZl.js";import{S as C}from"./select-dropdown-DMRw24fp.js";import{F,a as k,b as D,c as P,d as B,e as E,z as d}from"./index-RzghFC-a.js";import{u as H}from"./use-custom-toast-CqH72_jF.js";import{c as I}from"./IconSun-DCedqkE3.js";import"./search-context-Cmagidv2.js";import"./use-auth-DHccd34A.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]],U=I("toggle-left",L),m=[{label:"Бесплатный",value:"free"},{label:"Оплаченный",value:"paid"},{label:"Премиум оплаченный",value:"premium_paid"}],R=d.object({user_type:d.enum(m.map(t=>t.value),{required_error:"User type is required."})}),q=u.create(({userIds:t})=>{const o=u.useModal(),l="create",{showSuccessToast:r,showErrorToast:n}=H(),c=y({schema:R,apiService:x({url:"/accounts/users/toggle-user-type"}),queryKey:"users/toggle-user-type",invalidateQueriesOnMutate:!0,switchToEditOnCreate:!1,resetOnModeChange:!1,initialMode:l,recordId:null,defaultValues:{user_type:null},notifications:{onSuccess:s=>r({title:s}),onError:(s,a)=>n({title:s,description:a})},transformToApi(s){return{user_ids:t,user_type:s.user_type}}});return e.jsx(g,{formHook:c,modal:o,displayType:"dialog",getTitle:s=>"Toggle users",formName:"user-form",getSubmitButtonText:s=>"Save",children:({control:s})=>e.jsx(F,{...c.form,children:e.jsx("div",{className:"space-y-4 p-0.5",children:e.jsx(k,{control:s,name:"user_type",render:({field:a})=>e.jsxs(D,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(P,{className:"col-span-2 text-right",children:"User Type"}),e.jsx(B,{children:e.jsx(C,{items:m,defaultValue:a.value,onValueChange:a.onChange,placeholder:"Select user type",className:"col-span-4",isControlled:!0})}),e.jsx(E,{className:"col-span-4 col-start-3"})]})})})})})}),i=_(),V=new Map([["premium_paid","bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],["free","bg-neutral-300/40 border-neutral-300"],["paid","bg-sky-200/40 text-sky-900 dark:text-sky-100 border-sky-300"]]);function z(){const t=p.useMemo(()=>[i.accessor("id",{header:"ID",meta:{filter:{type:"text",displayType:"toolbar"}},enableHiding:!1}),i.accessor("username",{header:"Username",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},cell:({row:r})=>e.jsx(f,{className:"max-w-36",children:r.getValue("username")}),enableHiding:!1}),i.accessor("email",{header:"Email",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"}}}),i.accessor("user_type",{header:"Payment",enableSorting:!1,cell:({row:r})=>{var s;const{user_type:n}=r.original,c=V.get(n);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(w,{variant:"outline",className:N("capitalize",c),children:(s=m.find(a=>a.value===n))==null?void 0:s.label})})},meta:{filter:{type:"select",options:m,displayType:"toolbar"}}})],[]),o=M({name:"users",url:"/accounts/users/",columns:t,useRowSelection:!0}),l=o.datatable.table.getSelectedRowModel();return e.jsxs(e.Fragment,{children:[e.jsxs(b,{fixed:!0,children:[e.jsx(v,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(j,{}),e.jsx(T,{})]})]}),e.jsx(S,{children:e.jsx(h,{resource:o,topbar:{title:"User List",subtitle:"Manage your users and their roles here."},actions:[{id:"toggle-payment",label:"Toggle Payment",renderType:"actions-menu",callback:()=>{u.show(q,{userIds:l.rows.map(r=>r.original.id)}).then(()=>{o.query.refetch()})},disabled:l.rows.length===0,shortcutIcon:e.jsx(U,{})}]})})]})}const re=z;export{re as component};
