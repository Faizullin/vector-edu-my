import{N as i,r as d,j as e,z as u,s as T}from"./index-DQh6-uld.js";import{c as N,L as P,u as C,D as M}from"./use-resource-D_Sf-gj9.js";import{D as w,a as D}from"./delete-confirm-nice-dialog-GvGx0jE2.js";import{H as F,T as v,P as I,M as E}from"./theme-switch-CZRbTvJb.js";import{S as _}from"./search-Cxg_x99o.js";import{B as H}from"./badge-CaQ6wKJ8.js";import{u as j}from"./use-custom-toast-M785XCYm.js";import{c as k}from"./index-DxnMLqFP.js";import{u as B}from"./useMutation-DppR1fuU.js";import{a as q,C as A,c as L}from"./component-base-BGAKgd9u.js";import{S as z}from"./select-dropdown-zAryhJnq.js";import{F as R,a as x,b,c as h,d as V,e as g}from"./zod-DllzZRz3.js";import{I as O}from"./handle-server-error-BxJ_sWNo.js";import{P as $}from"./plus-B1eArzAP.js";import"./dropdown-menu-DzwRwAUd.js";import"./search-context-BRsiDa6R.js";import"./scroll-area-Dbi-VXH4.js";import"./IconSun-DUeqE8X5.js";import"./createReactComponent-CHdwuXdO.js";import"./separator-B8KvN21v.js";import"./use-auth-D3uw0lD2.js";const p=[{label:"Published",value:"1"},{label:"Draft",value:"0"}],K=u.object({title:u.string().min(1,{message:"Title is required."}),publication_status:u.string().min(1,{message:"Publication status is required."})}),y=i.create(o=>{const c=i.useModal(),n=d.useMemo(()=>o.recordId?"edit":"create",[o.recordId]),{showSuccessToast:l,showErrorToast:m}=j(),s=q({schema:K,apiService:L({url:"/resources/posts"}),queryKey:"posts",invalidateQueriesOnMutate:!0,initialMode:n,recordId:o.recordId,defaultValues:{title:"",publication_status:"0"},transformToForm(t){return{title:t.title,publication_status:t.publication_status.toString()}},notifications:{onSuccess:t=>{l({title:t,duration:2e3})},onError:t=>{m({title:t,duration:2e3})}}});return e.jsx(A,{formHook:s,modal:c,displayType:"dialog",getTitle:t=>t.formMode==="edit"?"Edit Post":"Create Post",formName:"posts-form",children:({control:t})=>e.jsx(R,{...s.form,children:e.jsxs("div",{className:"space-y-4 p-0.5 mb-6",children:[e.jsx(x,{control:t,name:"title",render:({field:a})=>e.jsxs(b,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(h,{className:"col-span-2 text-right",children:"Title"}),e.jsx(V,{children:e.jsx(O,{placeholder:"Title",className:"col-span-4",autoComplete:"off",...a})}),e.jsx(g,{className:"col-span-4 col-start-3"})]})}),e.jsx(x,{control:t,name:"publication_status",render:({field:a})=>e.jsxs(b,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(h,{className:"col-span-2 text-right",children:"Publication Status"}),e.jsx(z,{defaultValue:a.value,onValueChange:a.onChange,placeholder:"Select",className:"col-span-4",items:p,isControlled:!0}),e.jsx(g,{className:"col-span-4 col-start-3"})]})})]})})})}),r=N(),Q=new Map([[1,"bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],[0,"bg-neutral-300/40 border-neutral-300"]]);function G(){const{showSuccessToast:o}=j(),c=B({mutationFn:s=>T({url:`/resources/posts/${s}/`,method:"DELETE"})}),n=d.useMemo(()=>[r.accessor("id",{header:"ID",meta:{filter:{type:"text",displayType:"toolbar"}},enableHiding:!1}),r.accessor("title",{header:"Title",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},cell:({row:s})=>e.jsx(P,{className:"max-w-36",children:s.getValue("title")}),enableHiding:!1}),r.accessor("post_type",{header:"Post type",enableSorting:!1,meta:{filter:{type:"text",displayType:"toolbar"},sizeBorderStyle:!0},enableHiding:!0}),r.accessor("publication_status",{header:"Publication",enableSorting:!1,cell:({row:s})=>{var f;const{publication_status:t}=s.original,a=Q.get(t);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(H,{variant:"outline",className:k("capitalize",a),children:(f=p.find(S=>S.value===`${t}`))==null?void 0:f.label})})},meta:{filter:{type:"select",options:p,displayType:"toolbar"}}}),r.display({id:"actions",cell:({row:s})=>e.jsx(w,{row:s,defaultActions:{edit:{callback:({row:t})=>{i.show(y,{recordId:t.original.id,record:t.original})}},delete:{callback:({row:t})=>{i.show(D,{}).then(({result:a})=>{a&&(o({title:"Post deleted successfully",duration:2e3}),c.mutateAsync(t.original.id).then(()=>{l.query.refetch()}))})}}}})})],[]),l=C({name:"posts",url:"/resources/posts",columns:n}),m=d.useCallback(()=>{i.show(y,{})},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(F,{fixed:!0,children:[e.jsx(_,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(v,{}),e.jsx(I,{})]})]}),e.jsx(E,{children:e.jsx(M,{resource:l,topbar:{title:"Post List",subtitle:"Manage your posts."},actions:[{id:"add",label:"Add",renderType:"panel",callback:m,shortcutIcon:e.jsx($,{})}]})})]})}const xe=G;export{xe as component};
